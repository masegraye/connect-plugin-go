syntax = "proto3";

package connectplugin.health.v1;

option go_package = "github.com/example/connect-plugin-go/gen/plugin/v1;connectpluginv1";

// HealthService implements health checking compatible with grpc.health.v1.
service HealthService {
  // Check gets the health of the specified service.
  // If service name is empty, returns overall server health.
  rpc Check(HealthCheckRequest) returns (HealthCheckResponse);

  // Watch streams health status changes for the specified service.
  rpc Watch(HealthCheckRequest) returns (stream HealthCheckResponse);
}

message HealthCheckRequest {
  // Service name to check.
  // Empty string means overall server health.
  string service = 1;
}

message HealthCheckResponse {
  ServingStatus status = 1;
}

enum ServingStatus {
  SERVING_STATUS_UNSPECIFIED = 0;
  SERVING_STATUS_SERVING = 1;
  SERVING_STATUS_NOT_SERVING = 2;
  SERVING_STATUS_SERVICE_UNKNOWN = 3; // Used only by Watch
}
